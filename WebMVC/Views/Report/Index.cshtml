@using WebMVC.EntityFramework;
@using WebMVC.Models;
@using System.Web;
@{
    ViewBag.Title = "Detail";
    Layout = "~/Views/Shared/_Layout.cshtml";

    var SummaryReport = ViewBag.SummaryReport as MERCHANT_SUMMARY;
    var Regions = ViewBag.Regions as List<MERCHANT_SUMMARY>;
    var MerchantTypes = ViewBag.MerchantTypes as List<MERCHANT_SUMMARY>;

    var cardTypeReport = ViewBag.cardTypeReport as List<MERCHANT_SUMMARY>;
    var lineChartData = ViewBag.lineChartData as List<Statistic>;

    var DonutData = ViewBag.DonutData as String;
    var BarData = ViewBag.BarData as String;
    var LineData = ViewBag.LineData as String;
    var CardTypeData = ViewBag.CardTypeData as String;
}

<form id="mainform" method="POST">
    <input name="reportType" id="reportType" value="@Request["reportType"]" style="display:none" type="text">
    <input name="reportStartDate" id="reportStartDate" value="@Request["reportStartDate"]" style="display:none" type="text">
    <input name="reportEndDate" id="reportEndDate" value="@Request["reportEndDate"]" style="display:none" type="text">
    <input name="reportStartMonth" id="reportStartMonth" value="@Request["reportStartMonth"]" style="display:none" type="text">
    <input name="reportEndMonth" id="reportEndMonth" value="@Request["reportEndMonth"]" style="display:none" type="text">
    <input name="reportStartYear" id="reportStartYear" value="@Request["reportStartYear"]" style="display:none" type="text">
    <input name="reportEndYear" id="reportEndYear" value="@Request["reportEndYear"]" style="display:none" type="text">
    <input name="reportStartQuarter" id="reportStartQuarter" value="@Request["reportStartQuarter"]" style="display:none" type="text">
    <input name="reportEndQuarter" id="reportEndQuarter" value="@Request["reportEndQuarter"]" style="display:none" type="text">


    <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#quick-report">Quick Report</a></li>
        <li><a data-toggle="tab" href="#report-date">Report by Date</a></li>
        <li><a data-toggle="tab" href="#report-month">Report by Month</a></li>
        <li><a data-toggle="tab" href="#report-quarter">Report by Quarter</a></li>
        <li><a data-toggle="tab" href="#report-year">Report by Year</a></li>
    </ul>

    <div class="tab-content">
        <div id="quick-report" class="tab-pane fade in active">
            <br />
            <div>
                <div class="row">
                    <div class="col-sm-4">
                        <input class="btn btn-success" value="Report This Month" id="viewThisMonth" type="button">
                    </div>
                    <div class="col-sm-4">
                        <input class="btn btn-success" value="Report This Year" id="viewThisYear" type="button">
                    </div>
                    <div class="col-sm-4">
                        <input class="btn btn-success" value="Report This Quarter" id="viewThisQuarter" type="button">
                    </div>
                </div>
            </div>
            <br />
        </div>
        <div id="report-date" class="tab-pane fade in">
            <br />
            <div class="row">
                <div class="col-sm-4">
                    <div class="form-group">
                        <input type="text" class="form-control" id="startDay" placeholder="Start Day">
                    </div>
                </div>
                <div class="col-sm-4">
                    <input class="form-control form-control-inline" value="" id="endDay" placeholder="End Day" type="text">
                </div>
                <div class="col-sm-4">
                    <input class="btn btn-success" value="View" id="viewDay" type="button">
                </div>
            </div>
            <br />
        </div>
        <div id="report-month" class="tab-pane fade">
            <br />
            <div class="row">
                <div class="col-sm-4">
                    <div class="form-group">
                        <input class="form-control" value="" id="startMonth" type="text" placeholder="Start Month">
                    </div>
                </div>
                <div class="col-sm-4">
                    <input class="form-control" value="" id="endMonth" placeholder="End Month" type="text">
                </div>
                <div class="col-sm-4">
                    <input class="btn btn-success" value="View" id="viewMonth" type="button">
                </div>
            </div>
            <br />
        </div>
        <div id="report-quarter" class="tab-pane fade">
            <br />
            <div class="col">
                <div class="row-sm-4">
                    <div class="form-group">
                        <select id="startQuarter" class="form-control">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                        </select>
                        <input class="form-control" value="" id="startQuarterYear" placeholder="Start Quarter" type="text">
                    </div>
                </div>
                <div class="row-sm-4">
                    <select id="endQuarter" class="form-control">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                    <input class="form-control" value="" id="endQuarterYear" placeholder="End Quarter" type="text">
                </div>
                <div class="row-sm-4">
                    <input class="btn btn-success" value="View" id="viewQuarter" type="button">
                </div>
            </div>
            <br />
        </div>
        <div id="report-year" class="tab-pane fade">
            <br />
            <div class="row">
                <div class="col-sm-4">
                    <div class="form-group">
                        <input class="form-control" value="" id="startYear" placeholder="Start Year" type="text">
                    </div>
                </div>
                <div class="col-sm-4">
                    <input class="form-control" value="" id="endYear" placeholder="End Year" type="text">
                </div>
                <div class="col-sm-4">
                    <input class="btn btn-success" value="View" id="viewYear" type="button">
                </div>
            </div>
            <br />
        </div>
    </div>
</form>

@section header{
    <i class="fa fa-bar-chart-o"></i> Charts
    <a href="@Url.Action("Index", "Compare")" class="btn btn-primary">So sánh</a>
    @{ var urlReport = "Report/PrintPreview";
            if (!String.IsNullOrEmpty(ViewBag.UserCode))
            {
                urlReport += ("?UserCode=" + ViewBag.UserCode);

            }
        }
    <a class="btn btn-primary" onclick="document.getElementById('mainform').action = '@urlReport'; document.getElementById('mainform').submit();">Print</a>
}

<link href="~/Assets/css/myStyle.css" rel="stylesheet" />
<link rel="stylesheet" href="~/Assets/css/datepicker.css">

<script>
    var DonutData = [@Html.Raw(DonutData)];
    var BarData =  [@Html.Raw(BarData)];
    var LineData = [@Html.Raw(LineData)];
    var CardTypeData = [@Html.Raw(CardTypeData)];
</script>

<script src="/Assets/js/flot/excanvas.min.js"></script>
<script src="/Assets/bower_components/jquery/dist/jquery.min.js"></script>
<script src="~/Assets/js/bootstrap-datepicker.js"></script>
<script src="~/Assets/js/moment.js"></script>
<script src="~/Assets/js/MyCustomJS.js"></script>
<script src="~/Assets/js/ReportConfig.js"></script>


<!-- From Card Type -->
<div id="CardTypeModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">

        <div class="modal-content-heading">
            Card type detail
            <span class="close">×</span>
        </div>
        <div class="modal-content-body">
            <div class="modal-content-body-detail">
                <h3>American Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.AmericanExpressNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.AmericanExpressTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.AmericanExpressAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.AmericanExpressCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.AmericanExpressReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.AmericanExpressReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Debit Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.DebitCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.DebitCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.DebitCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.DebitCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.DebitCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.DebitCardReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Discover Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.DiscoverCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.DiscoverCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.DiscoverCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.DiscoverCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.DiscoverCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.DiscoverCardReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Foreign Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.ForeignCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.ForeignCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.ForeignCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.ForeignCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.ForeignCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.ForeignCardReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Master Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.MasterCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.MasterCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.MasterCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.MasterCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.MasterCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.MasterCardReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Visa Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.VisaCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.VisaCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.VisaCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.VisaCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.VisaCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.VisaCardReturnCount)</p>
                    </div>
                </div>
            </div>

            <div class="modal-content-body-detail">
                <h3>Master Card</h3>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total revenue: @(SummaryReport.OtherCardNetAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Total transaction: @(SummaryReport.OtherCardTransactionCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total sale: @(SummaryReport.OtherCardAmount)</p>
                    </div>
                    <div class="col-xs-9">
                        <p>Sale count: @(SummaryReport.OtherCardCount)</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-9">
                        <p>Total return: @(SummaryReport.OtherCardReturnAmount)</p>
                    </div>
                    <div class="col-xs-9 ">
                        <p>Return count: @(SummaryReport.OtherCardReturnCount)</p>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- End form card type-->
<!-- Form Religion-->
<div id="RegionModal" class="modal">

    <!-- Modal content -->

    <div class="modal-content">
        <div class="modal-content-heading">
            Region type detail
            <span class="close">×</span>
        </div>
        <div class="modal-content-body">
            @{
                foreach (var region in Regions)
                {
                    //var region = Regions.Find(x => x.RegionCode == regionCode);
                    <div class="modal-content-body-detail">
                        <h3>@region.RegionName</h3>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total revenue: @region.NetAmount </p>
                            </div>
                            <div class="col-xs-9 ">
                                <p>Total transaction: @region.TransactionCount </p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total sale: @region.SaleAmount </p>
                            </div>
                            <div class="col-xs-9">
                                <p>Sale count: @region.SaleCount </p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total return: @region.ReturnAmount</p>
                            </div>
                            <div class="col-xs-9 ">
                                <p>Return count: @region.ReturnCount</p>
                            </div>
                        </div>
                    </div>
                }
            }
        </div>
    </div>
</div>
<!-- End form religion-->
<!--Begin form merchant type -->
<div id="MerchantTypeModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">

        <div class="modal-content-heading">
            Merchant type detail
            <span class="close">×</span>
        </div>
        <div class="modal-content-body">
            @{
                foreach (var type in MerchantTypes)
                {
                    <div class="modal-content-body-detail">
                        <h3> @type.MerchantTypeName</h3>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total revenue:@type.NetAmount </p>
                            </div>
                            <div class="col-xs-9 ">
                                <p>Total transaction: @type.TransactionCount </p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total sale: @type.SaleAmount </p>
                            </div>
                            <div class="col-xs-9">
                                <p>Sale count: @type.SaleCount </p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-9">
                                <p>Total return: @type.ReturnAmount</p>
                            </div>
                            <div class="col-xs-9 ">
                                <p>Return count: @type.ReturnCount</p>
                            </div>
                        </div>
                    </div>

                }
            }
        </div>
    </div>
</div>
<!-- End form merchant type-->
<!-- Flot Charts -->
<div class="row">
    <div class="col-lg-3 col-md-6">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-money fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="h4">@SummaryReport.NetAmount</div>
                        <div>Total Revenue</div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="panel panel-green">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-shopping-cart fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="h4">@SummaryReport.SaleAmount</div>
                        <div>Total sales</div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="panel panel-yellow">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-warning fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="h4">@SummaryReport.ReturnAmount</div>
                        <div>Total returns</div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div class="col-lg-3 col-md-6">
        <div class="panel panel-red">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-xs-3">
                        <i class="fa fa-support fa-5x"></i>
                    </div>
                    <div class="col-xs-9 text-right">
                        <div class="h4">@SummaryReport.TransactionCount</div>
                        <div>Total transactions</div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-4" style="width:60%">
        <div class="panel panel-red">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Revenue Graph</h3>
            </div>
            <div class="panel-body">
                <div id="morris-line-chart"></div>
                <div id="detailRevenueBtn" class="text-right" onclick="Display('detailRevenueBtn','RevenueModal',-1)">

                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4" style="width:33%">
        <div class="panel panel-green">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Card Type</h3>
            </div>
            <div class="panel-body">
                <div class="flot-chart">
                    <div class="flot-chart-content" id="flot-pie-chart"></div>
                </div>
                <div id="detailCardTypeBtn" class="text-right" onclick="Display('detailCardTypeBtn','CardTypeModal',0)">
                    <a>View Details <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-4" style="width:60%;min-width:400px">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Region</h3>
            </div>
            <div class="panel-body">
                <div id="morris-bar-chart"></div>
                <div id="detailReligionBtn" class="text-right" onclick="Display('detailReligionBtn','RegionModal',1)">
                    <a>View Details <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-4" style="width:33%;min-width:400px">
        <div class="panel panel-yellow">
            <div class="panel-heading">
                <h3 class="panel-title"><i class="fa fa-long-arrow-right"></i> Merchant Type</h3>
            </div>
            <div class="panel-body">
                <div id="morris-donut-chart"></div>
                <div id="detailMerchantTypeBtn" class="text-right" onclick="Display('detailMerchantTypeBtn','MerchantTypeModal',2)">
                    <a>View Details <i class="fa fa-arrow-circle-right"></i></a>
                </div>
            </div>
        </div>
    </div>


</div>
<!-- /.row -->
